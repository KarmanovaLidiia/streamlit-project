import pandas as pd
import matplotlib.pyplot as plt
from collections import Counter
import numpy as np
import os
import warnings

warnings.filterwarnings('ignore')

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
plt.style.use('default')
plt.rcParams['font.family'] = 'DejaVu Sans'


def create_test_data():
    """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""

    test_data = """Id —ç–∫–∑–∞–º–µ–Ω–∞;Id –≤–æ–ø—Ä–æ—Å–∞;‚Ññ –≤–æ–ø—Ä–æ—Å–∞;–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞;–û—Ü–µ–Ω–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞;–¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞;pred_score;–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ_–æ—Ü–µ–Ω–∫–∏
3373871;30625752;1;"<p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —ç–∫–∑–∞–º–µ–Ω!</p>";1;"–≠–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä: –ù–∞—á–Ω–∏—Ç–µ –¥–∏–∞–ª–æ–≥. –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π: –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, —è —Ö–æ—Ç–µ–ª –±—ã –∏–∑–≤–∏–Ω–∏—Ç—å—Å—è, —á—Ç–æ –Ω–µ —Å–º–æ–≥—É –ø—Ä–∏–π—Ç–∏ –Ω–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è. –ß—Ç–æ –±—ã –≤—ã —Ö–æ—Ç–µ–ª–∏ –≤ –ø–æ–¥–∞—Ä–æ–∫?";0.99;"üü¢ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç | ‚úÖ –í—ã—Å–æ–∫–æ–µ —Å–º—ã—Å–ª–æ–≤–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | üìä –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ | üí¨ –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞ | ‚≠ê –í—ã—Å–æ–∫–∏–π –±–∞–ª–ª"
3373871;30625753;2;"<p>–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–º –∂–∏–ª—å–µ</p>";2;"–≠–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä: –í—ã –∂–∏–≤—ë—Ç–µ –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ –∏–ª–∏ –¥–æ–º–µ? –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π: –Ø –∂–∏–≤—É –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞. –≠—Ç–æ —Ç—Ä—ë—Ö–∫–æ–º–Ω–∞—Ç–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ —Å –±–∞–ª–∫–æ–Ω–æ–º. –ö–≤–∞—Ä—Ç–∏—Ä–∞ –Ω–æ–≤–∞—è, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –≤ 2020 –≥–æ–¥—É.";1.62;"üü¢ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç | ‚úÖ –í—ã—Å–æ–∫–æ–µ —Å–º—ã—Å–ª–æ–≤–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | üìä –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ | üè† –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ | ‚≠ê –í—ã—Å–æ–∫–∏–π –±–∞–ª–ª"
3373872;30625790;1;"<p>–ù–∞—á–Ω–∏—Ç–µ –¥–∏–∞–ª–æ–≥ –æ —Ä–∞–±–æ—Ç–µ</p>";1;"–≠–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä: –£–∑–Ω–∞–π—Ç–µ –æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö –∫ —Ä–∞–±–æ—Ç–µ. –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π: –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, —è —É–≤–∏–¥–µ–ª –≤–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –æ –≤–∞–∫–∞–Ω—Å–∏–∏. –ö–∞–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–æ–∏—Å–∫–∞—Ç–µ–ª—é? –ö–∞–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω—É–∂–Ω—ã?";0.87;"üü¢ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç | ‚ö†Ô∏è –£–º–µ—Ä–µ–Ω–Ω–æ–µ —Å–º—ã—Å–ª–æ–≤–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | üìä –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ | üí¨ –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞ | ‚≠ê –í—ã—Å–æ–∫–∏–π –±–∞–ª–ª"
3373872;30625791;2;"<p>–û–ø–∏—à–∏—Ç–µ –≤–∞—à–µ –∂–∏–ª—å–µ</p>";1;"–≠–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä: –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–π –∫–≤–∞—Ä—Ç–∏—Ä–µ. –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π: –£ –º–µ–Ω—è –∫–≤–∞—Ä—Ç–∏—Ä–∞. –û–Ω–∞ —Ö–æ—Ä–æ—à–∞—è. –¢—Ä–∏ –∫–æ–º–Ω–∞—Ç—ã.";0.45;"üìâ –ú–∞–ª–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π | ‚ùå –ù–∏–∑–∫–æ–µ —Å–º—ã—Å–ª–æ–≤–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | üìä –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞"
3373873;30625828;1;"<p>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</p>";2;"–≠–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä: –û–±—ä—è—Å–Ω–∏—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é –≤ –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–ª—É–∂–±–µ. –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π: –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –º–Ω–µ –Ω—É–∂–Ω–æ –æ—Ñ–æ—Ä–º–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –∫–∞—Ä—Ç—É. –Ø –ø—Ä–∏–µ—Ö–∞–ª –¥–≤–µ –Ω–µ–¥–µ–ª–∏ –Ω–∞–∑–∞–¥. –ú–æ–∂–µ—Ç–µ –¥–∞—Ç—å –º–Ω–µ –±–ª–∞–Ω–∫ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è?";1.85;"üü¢ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç | ‚úÖ –í—ã—Å–æ–∫–æ–µ —Å–º—ã—Å–ª–æ–≤–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | üìä –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ | üí¨ –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞ | ‚≠ê –í—ã—Å–æ–∫–∏–π –±–∞–ª–ª"
3373873;30625829;2;"<p>–í–∞—à–∏ –ª—é–±–∏–º—ã–µ —Ñ–∏–ª—å–º—ã</p>";1;"–≠–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä: –ö–∞–∫–∏–µ —Ñ–∏–ª—å–º—ã –≤—ã –ª—é–±–∏—Ç–µ? –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π: –Ø —Å–º–æ—Ç—Ä—é —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫—É –∏ –¥–µ—Ç–µ–∫—Ç–∏–≤—ã. –õ—é–±–ª—é –Ω–æ–≤—ã–µ —Ü–≤–µ—Ç–Ω—ã–µ —Ñ–∏–ª—å–º—ã. –ú–æ–π –ª—é–±–∏–º—ã–π —Ñ–∏–ª—å–º - –ò–Ω—Ç–µ—Ä—Å—Ç–µ–ª–ª–∞—Ä, –æ–Ω –æ –∫–æ—Å–º–æ—Å–µ –∏ –≤—Ä–µ–º–µ–Ω–∏.";1.15;"üü¢ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç | ‚ö†Ô∏è –£–º–µ—Ä–µ–Ω–Ω–æ–µ —Å–º—ã—Å–ª–æ–≤–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | üìä –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ | üí¨ –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞"
3373874;30625866;3;"<p>–û–ø–∏—à–∏—Ç–µ –∫–∞—Ä—Ç–∏–Ω–∫—É</p>";2;"–≠–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä: –ß—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ? –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π: –ù–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∞ —Å–µ–º—å—è –≤ –ø–∞—Ä–∫–µ. –î–µ—Ç–∏ –∏–≥—Ä–∞—é—Ç –≤ –º—è—á, —Ä–æ–¥–∏—Ç–µ–ª–∏ —Å–∏–¥—è—Ç –Ω–∞ —Å–∫–∞–º–µ–π–∫–µ. –Ø—Ä–∫–∏–π —Å–æ–ª–Ω–µ—á–Ω—ã–π –¥–µ–Ω—å, –ª–µ—Ç–æ.";1.92;"üü¢ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç | ‚úÖ –í—ã—Å–æ–∫–æ–µ —Å–º—ã—Å–ª–æ–≤–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | üé® –ï—Å—Ç—å –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∫–∞—Ä—Ç–∏–Ω–∫–∏ | üë§ –ï—Å—Ç—å –ª–∏—á–Ω—ã–π –æ–ø—ã—Ç | ‚≠ê –í—ã—Å–æ–∫–∏–π –±–∞–ª–ª"
3373874;30625867;4;"<p>–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Ö–æ–±–±–∏</p>";1;"–≠–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä: –ß–µ–º —É–≤–ª–µ–∫–∞–µ—Ç–µ—Å—å? –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π: –Ø —á–∏—Ç–∞—é –∫–Ω–∏–≥–∏. –ò–Ω–æ–≥–¥–∞ —Å–º–æ—Ç—Ä—é —Ñ–∏–ª—å–º—ã.";0.35;"üìâ –ú–∞–ª–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π | ‚ùå –ù–∏–∑–∫–æ–µ —Å–º—ã—Å–ª–æ–≤–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | üìä –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞"
3373875;30625904;1;"<p>–°–∏—Ç—É–∞—Ü–∏—è –≤ –±–æ–ª—å–Ω–∏—Ü–µ</p>";1;"–≠–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä: –£–∑–Ω–∞–π—Ç–µ –æ –ø—Ä–∏–µ–º–µ –≤—Ä–∞—á–∞. –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π: –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –º–Ω–µ –Ω—É–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ —Ç–µ—Ä–∞–ø–µ–≤—Ç—É –Ω–∞ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ. –ö–æ–≥–¥–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ä–∞—á –∏ –∫–∞–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω—É–∂–Ω—ã?";0.95;"üü¢ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç | ‚úÖ –í—ã—Å–æ–∫–æ–µ —Å–º—ã—Å–ª–æ–≤–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | üìä –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ | üí¨ –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞ | ‚≠ê –í—ã—Å–æ–∫–∏–π –±–∞–ª–ª"
3373875;30625905;2;"<p>–ö—É–ª–∏–Ω–∞—Ä–Ω—ã–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è</p>";2;"–≠–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä: –ö–∞–∫–∞—è –≤–∞—à–∞ –ª—é–±–∏–º–∞—è –∫—É—Ö–Ω—è? –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π: –Ø –æ—á–µ–Ω—å –ª—é–±–ª—é –∏—Ç–∞–ª—å—è–Ω—Å–∫—É—é –∫—É—Ö–Ω—é, –æ—Å–æ–±–µ–Ω–Ω–æ –ø–∞—Å—Ç—É –∏ –ø–∏—Ü—Ü—É. –¢–∞–∫–∂–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —è–ø–æ–Ω—Å–∫–∞—è –∫—É—Ö–Ω—è - —Å—É—à–∏ –∏ —Ä–æ–ª–ª—ã. –õ—é–±–ª—é –≥–æ—Ç–æ–≤–∏—Ç—å —Å–∞–º, –æ—Å–æ–±–µ–Ω–Ω–æ –≤—ã–ø–µ—á–∫—É.";1.78;"üü¢ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç | ‚úÖ –í—ã—Å–æ–∫–æ–µ —Å–º—ã—Å–ª–æ–≤–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | üìä –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ | üè† –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ | ‚≠ê –í—ã—Å–æ–∫–∏–π –±–∞–ª–ª"
"""

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª
    with open('test_data.csv', 'w', encoding='utf-8') as f:
        f.write(test_data)

    print("‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª 'test_data.csv' —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ")
    return True


def load_and_analyze_data():
    """–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""

    file_path = 'test_data.csv'

    try:
        df = pd.read_csv(file_path, encoding='utf-8', delimiter=';')
        print("‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: {e}")
        return None

    print("=" * 60)
    print("–¢–ï–°–¢–û–í–´–ô –ê–ù–ê–õ–ò–ó AI-–û–¶–ï–ù–û–ö")
    print("=" * 60)

    print(f"–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: {df.shape[0]} —Å—Ç—Ä–æ–∫, {df.shape[1]} –∫–æ–ª–æ–Ω–æ–∫")
    print(f"–ö–æ–ª–æ–Ω–∫–∏: {list(df.columns)}")
    print(f"\n–ü–µ—Ä–≤—ã–µ 3 —Å—Ç—Ä–æ–∫–∏:")
    print(df.head(3))

    return df


def basic_statistics(df):
    """–ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"""

    print("\n" + "=" * 40)
    print("–ë–ê–ó–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê")
    print("=" * 40)

    print("AI –æ—Ü–µ–Ω–∫–∏ (pred_score):")
    print(f"  –°—Ä–µ–¥–Ω–µ–µ: {df['pred_score'].mean():.3f}")
    print(f"  –ú–µ–¥–∏–∞–Ω–∞: {df['pred_score'].median():.3f}")
    print(f"  –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {df['pred_score'].std():.3f}")
    print(f"  –ú–∏–Ω–∏–º—É–º: {df['pred_score'].min():.3f}")
    print(f"  –ú–∞–∫—Å–∏–º—É–º: {df['pred_score'].max():.3f}")

    print("\n–û—Ü–µ–Ω–∫–∏ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞:")
    print(f"  –°—Ä–µ–¥–Ω–µ–µ: {df['–û—Ü–µ–Ω–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞'].mean():.3f}")
    print(f"  –ú–µ–¥–∏–∞–Ω–∞: {df['–û—Ü–µ–Ω–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞'].median():.3f}")
    print(f"  –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {df['–û—Ü–µ–Ω–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞'].std():.3f}")

    print("\n–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞:")
    —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ = df['–û—Ü–µ–Ω–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞'].value_counts().sort_index()
    for –æ—Ü–µ–Ω–∫–∞, count in —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.items():
        print(f"  {–æ—Ü–µ–Ω–∫–∞}: {count} –æ—Ç–≤–µ—Ç–æ–≤ ({count / len(df) * 100:.1f}%)")


def calculate_correlations(df):
    """–†–∞—Å—á–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π"""

    print("\n" + "=" * 40)
    print("–ö–û–†–†–ï–õ–Ø–¶–ò–ò –ò –†–ê–°–•–û–ñ–î–ï–ù–ò–Ø")
    print("=" * 40)

    correlation = df[['–û—Ü–µ–Ω–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞', 'pred_score']].corr().iloc[0, 1]
    print(f"–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –æ—Ü–µ–Ω–∫–∞–º–∏: {correlation:.3f}")

    df['—Ä–∞–∑–Ω–∏—Ü–∞'] = df['pred_score'] - df['–û—Ü–µ–Ω–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞']
    df['abs_—Ä–∞–∑–Ω–∏—Ü–∞'] = abs(df['—Ä–∞–∑–Ω–∏—Ü–∞'])

    print(f"–°—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞: {df['abs_—Ä–∞–∑–Ω–∏—Ü–∞'].mean():.3f}")
    print(f"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞: {df['abs_—Ä–∞–∑–Ω–∏—Ü–∞'].max():.3f}")
    print(f"–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞: {df['abs_—Ä–∞–∑–Ω–∏—Ü–∞'].min():.3f}")

    # –ê–Ω–∞–ª–∏–∑ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏
    print("\n–°–û–ì–õ–ê–°–û–í–ê–ù–ù–û–°–¢–¨ –û–¶–ï–ù–û–ö:")
    for –ø–æ—Ä–æ–≥ in [0.1, 0.3, 0.5, 1.0]:
        —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ = df[df['abs_—Ä–∞–∑–Ω–∏—Ü–∞'] < –ø–æ—Ä–æ–≥].shape[0]
        –ø—Ä–æ—Ü–µ–Ω—Ç = (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ / len(df)) * 100
        print(f"  –†–∞–∑–Ω–∏—Ü–∞ < {–ø–æ—Ä–æ–≥}: {—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ} –æ—Ç–≤–µ—Ç–æ–≤ ({–ø—Ä–æ—Ü–µ–Ω—Ç:.1f}%)")

    # –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü
    –∑–∞–≤—ã—à–µ–Ω–∏–µ = len(df[df['—Ä–∞–∑–Ω–∏—Ü–∞'] > 0])
    –∑–∞–Ω–∏–∂–µ–Ω–∏–µ = len(df[df['—Ä–∞–∑–Ω–∏—Ü–∞'] < 0])
    —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ = len(df[df['—Ä–∞–∑–Ω–∏—Ü–∞'] == 0])

    print(f"\n–ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï –†–ê–ó–ù–ò–¶:")
    print(f"  AI –∑–∞–≤—ã—à–∞–µ—Ç: {–∑–∞–≤—ã—à–µ–Ω–∏–µ} ({–∑–∞–≤—ã—à–µ–Ω–∏–µ / len(df) * 100:.1f}%)")
    print(f"  AI –∑–∞–Ω–∏–∂–∞–µ—Ç: {–∑–∞–Ω–∏–∂–µ–Ω–∏–µ} ({–∑–∞–Ω–∏–∂–µ–Ω–∏–µ / len(df) * 100:.1f}%)")
    print(f"  –ü–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ: {—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ} ({—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ / len(df) * 100:.1f}%)")


def create_visualizations(df):
    """–°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤"""

    print("\n" + "=" * 40)
    print("–°–û–ó–î–ê–ù–ò–ï –ì–†–ê–§–ò–ö–û–í")
    print("=" * 40)

    os.makedirs('graphs', exist_ok=True)

    # 1. Scatter plot
    plt.figure(figsize=(12, 8))
    scatter = plt.scatter(df['–û—Ü–µ–Ω–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞'], df['pred_score'],
                          c=df['abs_—Ä–∞–∑–Ω–∏—Ü–∞'], cmap='viridis', alpha=0.7, s=80)
    plt.colorbar(scatter, label='–ê–±—Å–æ–ª—é—Ç–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞')
    plt.plot([0, 2], [0, 2], 'r--', alpha=0.5, label='–ò–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ')
    plt.xlabel('–û—Ü–µ–Ω–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞', fontsize=12)
    plt.ylabel('AI –æ—Ü–µ–Ω–∫–∞ (pred_score)', fontsize=12)
    plt.title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–π –∏ AI –æ—Ü–µ–Ω–∫–∏\n(—Ü–≤–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ–ª–∏—á–∏–Ω—É —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è)', fontsize=14)
    plt.legend()
    plt.grid(True, alpha=0.3)
    plt.xticks([1, 2])
    plt.savefig('graphs/test_scatter.png', dpi=300, bbox_inches='tight')
    plt.close()

    # 2. –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ —Ä–∞–∑–Ω–∏—Ü
    plt.figure(figsize=(12, 6))
    plt.hist(df['—Ä–∞–∑–Ω–∏—Ü–∞'], bins=15, alpha=0.7, edgecolor='black', color='skyblue')
    plt.xlabel('–†–∞–∑–Ω–∏—Ü–∞ (AI - –ß–µ–ª–æ–≤–µ–∫)', fontsize=12)
    plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤', fontsize=12)
    plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü –º–µ–∂–¥—É AI –∏ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–º–∏ –æ—Ü–µ–Ω–∫–∞–º–∏', fontsize=14)
    plt.grid(True, alpha=0.3)
    plt.axvline(x=0, color='red', linestyle='--', alpha=0.8, label='–ù—É–ª–µ–≤–∞—è —Ä–∞–∑–Ω–∏—Ü–∞')
    plt.axvline(x=df['—Ä–∞–∑–Ω–∏—Ü–∞'].mean(), color='orange', linestyle='--',
                alpha=0.8, label=f'–°—Ä–µ–¥–Ω—è—è —Ä–∞–∑–Ω–∏—Ü–∞: {df["—Ä–∞–∑–Ω–∏—Ü–∞"].mean():.3f}')
    plt.legend()
    plt.savefig('graphs/test_histogram.png', dpi=300, bbox_inches='tight')
    plt.close()

    # 3. Box plot –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º
    plt.figure(figsize=(12, 6))
    box_data = [df[df['‚Ññ –≤–æ–ø—Ä–æ—Å–∞'] == question]['pred_score'].values
                for question in sorted(df['‚Ññ –≤–æ–ø—Ä–æ—Å–∞'].unique())]

    box_plot = plt.boxplot(box_data, labels=sorted(df['‚Ññ –≤–æ–ø—Ä–æ—Å–∞'].unique()),
                           patch_artist=True)

    # –†–∞—Å–∫—Ä–∞—à–∏–≤–∞–µ–º boxplot
    colors = ['lightblue', 'lightgreen', 'lightcoral', 'lightyellow', 'lightpink']
    for patch, color in zip(box_plot['boxes'], colors):
        patch.set_facecolor(color)

    plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ AI –æ—Ü–µ–Ω–æ–∫ –ø–æ –Ω–æ–º–µ—Ä–∞–º –≤–æ–ø—Ä–æ—Å–æ–≤', fontsize=14)
    plt.xlabel('–ù–æ–º–µ—Ä –≤–æ–ø—Ä–æ—Å–∞', fontsize=12)
    plt.ylabel('AI –æ—Ü–µ–Ω–∫–∞ (pred_score)', fontsize=12)
    plt.grid(True, alpha=0.3)
    plt.savefig('graphs/test_boxplot.png', dpi=300, bbox_inches='tight')
    plt.close()

    print("‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–ø–∫—É 'graphs/'")


def analyze_explanations(df):
    """–ê–Ω–∞–ª–∏–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π"""

    print("\n" + "=" * 40)
    print("–ê–ù–ê–õ–ò–ó –û–ë–™–Ø–°–ù–ï–ù–ò–ô")
    print("=" * 40)

    –≤—Å–µ_–æ–±—ä—è—Å–Ω–µ–Ω–∏—è = ' '.join(df['–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ_–æ—Ü–µ–Ω–∫–∏'].dropna().astype(str))
    —Å–ª–æ–≤–∞ = [word.strip() for word in –≤—Å–µ_–æ–±—ä—è—Å–Ω–µ–Ω–∏—è.split() if len(word.strip()) > 2]
    —á–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç—å = Counter(—Å–ª–æ–≤–∞)

    print("–¢–æ–ø-10 —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –≤ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è—Ö:")
    for —Å–ª–æ–≤–æ, count in —á–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç—å.most_common(10):
        print(f"  {—Å–ª–æ–≤–æ}: {count}")


def save_detailed_analysis(df):
    """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞"""

    print("\n" + "=" * 40)
    print("–°–û–•–†–ê–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í")
    print("=" * 40)

    # –°–æ–∑–¥–∞–µ–º –∫–æ–ø–∏—é —Å –∞–Ω–∞–ª–∏–∑–æ–º
    df_analysis = df.copy()

    # –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—é —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π
    —É—Å–ª–æ–≤–∏—è = [
        df_analysis['abs_—Ä–∞–∑–Ω–∏—Ü–∞'] < 0.1,
        df_analysis['abs_—Ä–∞–∑–Ω–∏—Ü–∞'] < 0.3,
        df_analysis['abs_—Ä–∞–∑–Ω–∏—Ü–∞'] < 0.5,
        df_analysis['abs_—Ä–∞–∑–Ω–∏—Ü–∞'] >= 0.5
    ]
    –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ = ['–û—Ç–ª–∏—á–Ω–æ–µ', '–•–æ—Ä–æ—à–µ–µ', '–£–º–µ—Ä–µ–Ω–Ω–æ–µ', '–ù–∏–∑–∫–æ–µ']
    df_analysis['–∫–∞—á–µ—Å—Ç–≤–æ_—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è'] = np.select(—É—Å–ª–æ–≤–∏—è, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, default='–ù–∏–∑–∫–æ–µ')

    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –Ω–∞–∏–±–æ–ª—å—à–∏–º —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è–º
    df_analysis = df_analysis.sort_values('abs_—Ä–∞–∑–Ω–∏—Ü–∞', ascending=False)

    try:
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Excel
        with pd.ExcelWriter('detailed_analysis.xlsx', engine='openpyxl') as writer:
            df_analysis.to_excel(writer, sheet_name='–í—Å–µ_–¥–∞–Ω–Ω—ã–µ_—Å_–∞–Ω–∞–ª–∏–∑–æ–º', index=False)
        print("‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ 'detailed_analysis.xlsx'")
    except Exception as e:
        print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å Excel: {e}")


def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""

    print("–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö...")
    if not create_test_data():
        return

    df = load_and_analyze_data()
    if df is None:
        return

    basic_statistics(df)
    calculate_correlations(df)
    create_visualizations(df)
    analyze_explanations(df)
    save_detailed_analysis(df)

    print("\n" + "=" * 60)
    print("‚úÖ –¢–ï–°–¢–û–í–´–ô –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù!")
    print("=" * 60)
    print("üìä –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:")
    print("   ‚Ä¢ test_data.csv - —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ")
    print("   ‚Ä¢ graphs/test_scatter.png - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫")
    print("   ‚Ä¢ graphs/test_histogram.png - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü")
    print("   ‚Ä¢ graphs/test_boxplot.png - –æ—Ü–µ–Ω–∫–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º")
    print("   ‚Ä¢ detailed_analysis.xlsx - –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç")


if __name__ == "__main__":
    main()